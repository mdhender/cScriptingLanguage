<html><head><title>CSL Reference&nbsp-&nbsp;strParseRecord</title>
<meta name="description" content="strParseRecord">
<meta name="keywords" content="PROGRAMMING CSL C SCRIPT SCRIPTING LANGUAGE IBK ORACLE MYSQL DB2 ODBC VISUALAGE BORLAND VISUAL C++ GCC">
</head>
<body leftmargin="10" topmargin="2"
text="#000000" bgcolor="#FFFFFF" link="#002288" vlink="#444444" alink="#FF2200">
<div align="center">
<a name="top"></a>
<!-- upper -->
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td></td>
<td width="5">&nbsp;</td>
<td width="150">
<a href="index.htm"><img src="../img/csl.png" width="97" height="56" border="0"></a>
</td>
<td width="300%" align="center" valign="bottom">
<h1>strParseRecord</h1>
</td>
<td width="150" align="right">
<table border="0" cellspacing="0" cellpadding="0">
<tr><td nowrap align="right" valign="top"><font size="-2"><b>
C&nbsp;Scripting&nbsp;Language<br>
Reference&nbsp;Manual<br>
Version&nbsp;4.4.0<br></b>
<br>&lt;&lt;&nbsp;<a href="strE.htm">Back</a>&nbsp;&nbsp;<a href="#end">End</a>&nbsp;&nbsp;<a href="strF.htm">Next</a>&nbsp;&gt;&gt;<br>
</font>
</td></tr>
</table>
</td>
<td width="5">&nbsp;</td>
<td></td>
</tr>
</table>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<!-- fine line  -->
<tr valign="bottom">
<td></td>
<td width="5"><img src="../img/1pix.png" width="1" height="1"></td>
<td width="150" bgcolor="#0044AA"><img src="../img/1pix.png" width="1" height="1"></td>
<td width="10" bgcolor="#0044AA"><img src="../img/1pix.png" width="1" height="1"></td>
<td width="300%" bgcolor="#0044AA"><img src="../img/1pix.png" width="1" height="1"></td>
<td width="5"><img src="../img/1pix.png" width="1" height="1"></td>
<td></td>
</tr>
<!-- space -->
<tr>
<td colspan="9"><img src="../img/1pix.png" width="1" height="1" vspace="4"></td>
</tr>
<!-- left column -->
<tr valign="top">
<td></td>
<td>&nbsp;</td>
<td bgcolor="#E0E0E0" width="150">
<table cellspacing="0" cellpadding="2" border="0" width="100%">
<tr>
<td nowrap bgcolor="#0044AA"><b><font color="#FFFFFF">INDEX</font></b></td>
</tr>
<tr>
<td nowrap><font size="-1">
<a href="intro1.htm">Introduction</a><br>
<a href="inst1.htm">Installation</a><br>
<a href="using1.htm">Using the CSL executive</a><br>
<a href="lang1.htm">Language</a><br>
<a href="direct1.htm">Directives</a><br>
<a href="sys1.htm">System library</a><br>
<a href="str1.htm">String library</a><br>
&nbsp;&nbsp;&nbsp;<a href="str2.htm">strAscii</a><br>
&nbsp;&nbsp;&nbsp;<a href="strS.htm">strBuildRecord</a><br>
&nbsp;&nbsp;&nbsp;<a href="str3.htm">strCenter</a><br>
&nbsp;&nbsp;&nbsp;<a href="str4.htm">strChange</a><br>
&nbsp;&nbsp;&nbsp;<a href="str5.htm">strChar</a><br>
&nbsp;&nbsp;&nbsp;<a href="str6.htm">strExport</a><br>
&nbsp;&nbsp;&nbsp;<a href="str7.htm">strFormatNumber</a><br>
&nbsp;&nbsp;&nbsp;<a href="str8.htm">strImport</a><br>
&nbsp;&nbsp;&nbsp;<a href="str9.htm">strIndexOf</a><br>
&nbsp;&nbsp;&nbsp;<a href="strA.htm">strIsInteger</a><br>
&nbsp;&nbsp;&nbsp;<a href="strB.htm">strIsNumber</a><br>
&nbsp;&nbsp;&nbsp;<a href="strU.htm">strLastIndexOf</a><br>
&nbsp;&nbsp;&nbsp;<a href="strC.htm">strLeftJustify</a><br>
&nbsp;&nbsp;&nbsp;<a href="strD.htm">strLength</a><br>
&nbsp;&nbsp;&nbsp;<a href="strE.htm">strLower</a><br>
&nbsp;&nbsp;&nbsp;<a href="strT.htm">strParseRecord</a><br>
&nbsp;&nbsp;&nbsp;<a href="strF.htm">strRemoveWords</a><br>
&nbsp;&nbsp;&nbsp;<a href="strG.htm">strRightJustify</a><br>
&nbsp;&nbsp;&nbsp;<a href="strH.htm">strSplitConnectString</a><br>
&nbsp;&nbsp;&nbsp;<a href="strI.htm">strSplitPath</a><br>
&nbsp;&nbsp;&nbsp;<a href="strJ.htm">strSpread</a><br>
&nbsp;&nbsp;&nbsp;<a href="strK.htm">strStrip</a><br>
&nbsp;&nbsp;&nbsp;<a href="strL.htm">strStripExtension</a><br>
&nbsp;&nbsp;&nbsp;<a href="strM.htm">strStripLeading</a><br>
&nbsp;&nbsp;&nbsp;<a href="strN.htm">strStripTrailing</a><br>
&nbsp;&nbsp;&nbsp;<a href="strO.htm">strSubString</a><br>
&nbsp;&nbsp;&nbsp;<a href="strP.htm">strUpper</a><br>
&nbsp;&nbsp;&nbsp;<a href="strQ.htm">strWordCount</a><br>
&nbsp;&nbsp;&nbsp;<a href="strR.htm">strWords</a><br>
<a href="math1.htm">Math library</a><br>
<a href="rex1.htm">Regular expression lib.</a><br>
<a href="file1.htm">File library</a><br>
<a href="dax1.htm">Database library</a><br>
<a href="comm1.htm">Async Communication</a><br>
<a href="prf1.htm">Registry/Profile handling</a><br>
<a href="win1.htm">Windows control</a><br>
<a href="capi1.htm">C API</a><br>
<a href="api1.htm">C++ Class Interface</a><br>
<a href="link1.htm">CSL links</a><br>
</font></td>
</tr>
</table>
</td>
<!-- main column -->
<td>&nbsp;&nbsp;</td>
<td width="300%">
<pre>
strParseRecord(
  const rec,                  // record to parse
  const mode,                 // file mode (1)
  const &amp;fmts[],              // field formats (2)
  var &amp;vals[],                // fiels values returned
 [const nullind]);            // null indicators in vals (default=false)
</pre><p>
Parses an ASCII record. Typically used by database import scripts
together with the <i>dax</i> and <i>file</i> libraries.
These file modes are supported:
</p><p>
<table border="0" cellpadding="3" cellspacing="0">
 <tr bgcolor="#0044AA" valign="top">
  <td><font color="#FFFFFF"><b>Mode</b></font></td>
  <td bgcolor="#0034AA"><font color="#FFFFFF"><b>Description</b></font></td>
 </tr>
 <tr bgcolor="#C0E0FF" valign="top">
  <td>A,a</td>
  <td bgcolor="#B0D0FF">ASCII fix</td>
 </tr>
 <tr bgcolor="#E0F0FF" valign="top">
  <td>C,c</td>
  <td bgcolor="#D0E0FF">Comma separated</td>
 </tr>
 <tr bgcolor="#C0E0FF" valign="top">
  <td>S, s</td>
  <td bgcolor="#B0D0FF">Semicolon separated</td>
 </tr>
 <tr bgcolor="#E0F0FF" valign="top">
  <td>T,t</td>
  <td bgcolor="#D0E0FF">Tab separated, text in quotes</td>
 </tr>
 <tr bgcolor="#C0E0FF" valign="top">
  <td>U,u</td>
  <td bgcolor="#B0D0FF">Tab separated, text unquoted</td>
 </tr>
</table>
</p><p>
The field formats are records of 2 ... n words. The 1st word
is a field type from this list:
</p><p>
<table border="0" cellpadding="3" cellspacing="0">
 <tr bgcolor="#0044AA" valign="top">
  <td><font color="#FFFFFF"><b>Format</b></font></td>
  <td bgcolor="#0034AA"><font color="#FFFFFF"><b>Description</b></font></td>
 </tr>
 <tr bgcolor="#C0E0FF" valign="top">
  <td>T,t</td>
  <td bgcolor="#B0D0FF">text</td>
 </tr>
 <tr bgcolor="#E0F0FF" valign="top">
  <td>F,f</td>
  <td bgcolor="#D0E0FF">fixtext (ignored)</td>
 </tr>
 <tr bgcolor="#C0E0FF" valign="top">
  <td>n</td>
  <td bgcolor="#B0D0FF">number with decimal point (leading sign)</td>
 </tr>
 <tr bgcolor="#E0F0FF" valign="top">
  <td>N</td>
  <td bgcolor="#D0E0FF">number with decimal point (trailing sign)</td>
 </tr>
 <tr bgcolor="#C0E0FF" valign="top">
  <td>x</td>
  <td bgcolor="#B0D0FF">number with fixed fraction digits (no decimal point, leading sign)</td>
 </tr>
 <tr bgcolor="#E0F0FF" valign="top">
  <td>X</td>
  <td bgcolor="#D0E0FF">number with fixed fraction digits (no decimal point, trailing sign)</td>
 </tr>
</table>
</p><p>
The next words are used as:
</p>
<ul>
 <li>2nd word = (maximum) width in chars<br><br>
 <li>3rd word (numbers only) = # of fractional digits
</ul>
<p>
The data extracted from the record are stored in <i>vals</i>. If <i>nullind</i> is true,
the data is arranged in 2 columns (for example data[totFields][2]), where the first
(index 0) holds the value and the second (index 1) is the NULL value indicator
(true/1 = value is null, false/0 = value is not null).
</p><p>
Example:
</p><pre>
  ...
  const dataLayout = {
    't 20',        // article #
    't 30',        // name
    'n  6',        // actual stock
    'f  3',        // currency, ignore
    'n  8 2'       // price
  };
  ...
  var fvals[4];
  strParseRecord(
    &quot;'1122.344.102.00';'Leather football champion';112;'USD';12.95&quot;,
    's', dataLayout, fvals)
  );
  // The result will be:
  //   fvals[0] = '1122.344.102.00';
  //   fvals[1] = 'Leather football champion';
  //   fvals[2] = 112;
  //   fvals[3] = 12.95;
  ...
</pre>

</td>
</tr>
<!-- space -->
<tr>
<td colspan="9"><img src="../img/1pix.png" width="1" height="1" vspace="4"></td>
</tr>
<!-- fine line  -->
<tr valign="bottom">
<td></td>
<td width="5"><img src="../img/1pix.png" width="1" height="1"></td>
<td width="150" bgcolor="#0044AA"><img src="../img/1pix.png" width="1" height="1"></td>
<td width="10" bgcolor="#0044AA"><img src="../img/1pix.png" width="1" height="1"></td>
<td width="300%" bgcolor="#0044AA"><img src="../img/1pix.png" width="1" height="1"></td>
<td width="5"><img src="../img/1pix.png" width="1" height="1"></td>
<td></td>
</tr>
</table>
<!-- lower line -->
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td></td>
<td width="5">&nbsp;</td>
<td width="25%">
<font size="-2">Copyright &copy; <A HREF="http://ibk-software.ch">IBK Landquart</font></td>
<td width="50%" align="center">
<font size="-2">Last revision: 27.05.2002
</font></td>
<td width="25%" align="right">
<font size="-2">&lt;&lt; <a href="strE.htm">Back</a>&nbsp;&nbsp;<a href="#top">Top</a>&nbsp;&nbsp;<a href="strF.htm">Next</a> &gt;&gt;</font></td>
<td width="5">&nbsp;</td>
<td></td>
</tr>
</table></div>
<a name="end"></a>
</body></html>
